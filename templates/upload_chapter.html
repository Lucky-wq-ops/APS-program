<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Upload Chapter</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/site.css') }}">
</head>
<body>
<div class="page">
    <h2>Upload Chapter{% if series %}: {{ series.title }}{% endif %}</h2>

    <div class="card">
        <form method="POST" enctype="multipart/form-data">
            <label for="chapter_number">Chapter Number:</label>
            <input id="chapter_number" type="number" name="chapter_number" required>

            <label for="chapter_folder">Select Chapter Folder:</label>
            <input
                id="chapter_folder"
                type="file"
                name="images[]"
                webkitdirectory
                mozdirectory
                directory
                multiple
                accept=".jpg,.jpeg,.png,.webp,.gif,.bmp,.avif,image/*"
                required
            >
            <p class="muted">Choose one folder that contains all page images.</p>
            <p id="folder-file-count" class="muted"></p>

            <div class="actions">
                <button class="btn" type="submit">Upload Chapter</button>
                <a class="btn secondary" href="{{ url_for('admin_panel') }}">Back to Library</a>
            </div>
        </form>
    </div>
</div>
<script>
  (function () {
    const input = document.getElementById("chapter_folder");
    const info = document.getElementById("folder-file-count");
    if (!input || !info) return;

    input.addEventListener("change", () => {
      const total = input.files ? input.files.length : 0;
      info.textContent = total ? `${total} image file(s) selected from folder.` : "";
    });
  })();
</script>
</body>
</html>
